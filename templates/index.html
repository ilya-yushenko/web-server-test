<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ—è –ü–∞—Å–µ–∫–∞</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- –í–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

<!-- –õ–µ–Ω–¥—ñ–Ω–≥–æ–≤–∞ —à–∞–ø–∫–∞ Honey Flow -->
<header class="header-landing">
    <div class="overlay"></div>
    <div class="container text-center">
        <!-- –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç —à–∞–ø–∫–∏ -->
        <div class="header-content">
            <h1 class="display-3 fw-bold">Hony</h1>
            <p class="lead">–¢–≤–æ—è –±—É–¥–µ–Ω–Ω—ñ—Å—Ç—å –º–æ–∂–µ –±—É—Ç–∏ —Å–æ–ª–æ–¥—à–æ—é</p>
            <a href="#products" class="btn btn-primary btn-lg mt-3">–ó—Ä–æ–±–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</a>
        </div>
    </div>
</header>

<!-- –ü—Ä–æ Hony -->
<section class="container my-5">
    <h2 class="text-center mb-4">–ü—Ä–æ –Ω–∞—Å</h2>
    <p>
        <strong>Hony</strong> ‚Äî —Ü–µ —Å—É—á–∞—Å–Ω–∏–π –±—Ä–µ–Ω–¥ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–≥–æ –º–µ–¥—É, —â–æ –ø–æ—î–¥–Ω—É—î —è–∫—ñ—Å—Ç—å, –ø—Ä–æ—Å—Ç–æ—Ç—É —Ç–∞ –µ—Å—Ç–µ—Ç–∏–∫—É.
        –ú–∏ —Ä–æ–±–∏–º–æ –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ—Å—Ç—ñ –ø—Ä–æ–¥—É–∫—Ç—É. –ö–æ–∂–Ω–∞ –±–∞–Ω–æ—á–∫–∞ –º–µ–¥—É ‚Äî —Ü–µ —á–∏—Å—Ç–∏–π —Å–º–∞–∫ —Ç–∞ –ø—Ä–æ–∑–æ—Ä–µ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è.
    </p>
    –°–ø—Ä–∞–≤–∂–Ω—ñ–π –º–µ–¥ –±–µ–∑ –∑–∞–π–≤–∏—Ö —Å–ª—ñ–≤. –ü—Ä–æ—Å—Ç–æ. –°—É—á–∞—Å–Ω–æ. –°–º–∞—á–Ω–æ. üçØ</p>
</section>

<!-- Products Section -->
<section id="products" class="container my-5 text-center">
    <h2 class="text-center mb-4">–ù–∞—à–∞ –ø—Ä–æ–¥—É–∫—Ü—ñ—è</h2>
    <div id="productList" class="row"></div>
</section>

<!-- Order Section -->
<section id="order" class="container my-5">
    <h2 class="text-center mb-4">–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>
    <p class="text-center text-muted mb-4">–ó–∞–ø–æ–≤–Ω—ñ—Ç—å —Ñ–æ—Ä–º—É –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</p>

    <div class="row justify-content-center">
        <div class="col-md-8">
            <form id="orderFormSection" class="p-4 shadow-sm rounded bg-white">
                <!-- –ü—Ä–æ–¥—É–∫—Ç —Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å -->
                <div class="row mb-3">
                    <div class="col-md-8">
                        <label for="productNameSection" class="form-label">–ü—Ä–æ–¥—É–∫—Ç</label>
                        <select class="form-select" id="productNameSection" required>
                            <option value="" disabled selected>–û–±–µ—Ä—ñ—Ç—å –ø—Ä–æ–¥—É–∫—Ç</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label for="productQuantitySection" class="form-label">–ö—ñ–ª—å–∫—ñ—Å—Ç—å (–∫–≥/–≥)</label>
                        <input type="text" class="form-control" id="productQuantitySection" placeholder="500 –≥ / 1 –∫–≥"
                               required>
                    </div>
                </div>

                <!-- –Ü–º'—è -->
                <div class="mb-3">
                    <label for="orderCustomerNameSection" class="form-label">–Ü–º'—è</label>
                    <input type="text" class="form-control" id="orderCustomerNameSection" placeholder="–í–∞—à–µ —ñ–º'—è"
                           required>
                </div>

                <!-- –¢–µ–ª–µ—Ñ–æ–Ω -->
                <div class="mb-3">
                    <label for="orderCustomerPhoneSection" class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                    <input type="tel" class="form-control" id="orderCustomerPhoneSection" placeholder="+380123456789"
                           required>
                </div>

                <!-- –ê–¥—Ä–µ—Å–∞ -->
                <div class="mb-3">
                    <label for="orderCustomerAddressSection" class="form-label">–ê–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏</label>
                    <input type="text" class="form-control" id="orderCustomerAddressSection" placeholder="–í–∞—à–∞ –∞–¥—Ä–µ—Å–∞"
                           required>
                </div>

                <!-- –ö–æ–º–µ–Ω—Ç–∞—Ä -->
                <div class="mb-3">
                    <label for="orderCustomerCommentSection" class="form-label">–ö–æ–º–µ–Ω—Ç–∞—Ä</label>
                    <textarea class="form-control" id="orderCustomerCommentSection" rows="3"
                              placeholder="–î–æ–¥–∞—Ç–∫–æ–≤—ñ –ø–æ–±–∞–∂–∞–Ω–Ω—è"></textarea>
                </div>

                <!-- –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è -->
                <button type="submit" class="btn btn-primary w-100">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
            </form>
            <div id="orderResponse" class="mt-3"></div>
        </div>
    </div>
</section>

<!-- Contact Section -->
<section id="contact" class="container my-5">
    <h2 class="text-center mb-4">–ó–≤'—è–∑–∞—Ç–∏—Å—è –∑ –Ω–∞–º–∏</h2>
    <p class="text-center text-muted mb-4">–ú–∞—î—Ç–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è –∞–±–æ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó? –ó–∞–ø–æ–≤–Ω—ñ—Ç—å —Ñ–æ—Ä–º—É –Ω–∏–∂—á–µ.</p>

    <div class="row justify-content-center">
        <!-- –§–æ—Ä–º–∞ –∑–≤'—è–∑–∫—É -->
        <div class="col-md-8">
            <form id="contactForm" class="p-4 shadow-sm rounded bg-white">
                <!-- –Ü–º'—è -->
                <div class="mb-3">
                    <label for="contactName" class="form-label">–Ü–º'—è</label>
                    <input type="text" class="form-control" id="contactName" placeholder="–í–∞—à–µ —ñ–º'—è" required>
                </div>
                <!-- Email -->
                <div class="mb-3">
                    <label for="contactEmail" class="form-label">Email</label>
                    <input type="email" class="form-control" id="contactEmail" placeholder="–í–∞—à Email" required>
                </div>
                <!-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è -->
                <div class="mb-3">
                    <label for="contactMessage" class="form-label">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</label>
                    <textarea class="form-control" id="contactMessage" rows="4" placeholder="–í–∞—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"
                              required></textarea>
                </div>
                <!-- –ö–Ω–æ–ø–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ -->
                <button type="submit" class="btn btn-primary w-100">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
            </form>
            <div id="messageResponse" class="mt-3"></div>
        </div>
    </div>
</section>

<!-- Footer -->
<footer class="text-center p-3 bg-dark text-white">
    <p>¬© 2024 Hony. –£—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω—ñ.</p>
</footer>
</body>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const productSelect = document.getElementById('productNameSection');

        async function fetchProducts() {
            try {
                const response = await fetch('/api/products');
                if (!response.ok) {
                    throw new Error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç—ñ–≤');
                }
                const products = await response.json();
                populateProductDropdown(products);
                renderProducts(products);
            } catch (error) {
                console.error('‚ùå –°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞:', error);
            }
        }

        function populateProductDropdown(products) {
            productSelect.innerHTML = '<option value="" disabled selected>–û–±–µ—Ä—ñ—Ç—å –ø—Ä–æ–¥—É–∫—Ç</option>';
            products.forEach(product => {
                const option = document.createElement('option');
                option.value = product.name;
                option.textContent = product.name;
                productSelect.appendChild(option);
            });
        }

        function renderProducts(products) {
            const productList = document.getElementById('productList');
            productList.innerHTML = '';

            products.forEach(product => {
                productList.innerHTML += `
                <div class="col-md-4 mb-4">
                    <div class="card h-100 shadow-sm">
                        <img src="${product.image}" class="card-img-top" alt="${product.name}">
                        <div class="card-body d-flex flex-column justify-content-between">
                            <h5 class="card-title text-center">${product.name}</h5>
                            <p class="card-text flex-grow-1 text-center">${product.description}</p>
                            <p class="text-center mt-3"><strong>${product.price} –≥—Ä–Ω / ${product.unit}</strong></p>
                            <button class="btn btn-primary w-100 mt-3 buy-btn" data-product="${product.name}" data-quantity="${product.unit}">
                                –ö—É–ø–∏—Ç–∏
                            </button>
                        </div>
                    </div>
                </div>
            `;
            });

            attachBuyButtonListeners();
        }

        function attachBuyButtonListeners() {
            const updatedBuyButtons = document.querySelectorAll('.buy-btn');
            updatedBuyButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const productName = button.dataset.product;
                    const productQuantity = button.dataset.quantity;

                    productNameInput.value = productName;
                    productQuantityInput.value = productQuantity;

                    document.getElementById('order').scrollIntoView({ behavior: 'smooth' });
                });
            });
        }

        fetchProducts();

        const buyButtons = document.querySelectorAll('.buy-btn');
        const productNameInput = document.getElementById('productNameSection');
        const productQuantityInput = document.getElementById('productQuantitySection');

        buyButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                e.preventDefault();
                const productName = button.getAttribute('data-product');
                const productQuantity = button.getAttribute('data-quantity');

                // –ó–∞–ø–æ–≤–Ω—é—î–º–æ –ø–æ–ª—è —Ñ–æ—Ä–º–∏
                productNameInput.value = productName;
                productQuantityInput.value = productQuantity;

                // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–æ —Ñ–æ—Ä–º–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
                const orderSection = document.getElementById('order');
                if (orderSection) {
                    orderSection.scrollIntoView({behavior: 'smooth'});
                }
            });
        });

        const orderForm = document.getElementById('orderFormSection');
        const orderResponse = document.getElementById('orderResponse');

        orderForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const orderProduct = productNameInput.value
            const orderQuantity = productQuantityInput.value
            const orderCustomerName = document.getElementById('orderCustomerNameSection').value;
            const orderCustomerPhone = document.getElementById('orderCustomerPhoneSection').value;
            const orderCustomerAddress = document.getElementById('orderCustomerAddressSection').value;
            const orderCustomerComment = document.getElementById('orderCustomerCommentSection').value;

            orderResponse.innerHTML = '';
            try {
                const response = await fetch('/order', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        orderProduct,
                        orderQuantity,
                        orderCustomerName,
                        orderCustomerPhone,
                        orderCustomerAddress,
                        orderCustomerComment
                    })
                });

                const result = await response.json();
                if (response.ok) {
                    orderResponse.innerHTML = `
                    <div class="alert alert-success">${result.message}</div>
                `;
                    orderForm.reset();
                } else {
                    orderResponse.innerHTML = `
                    <div class="alert alert-danger">${result.message}</div>
                `;
                }
            } catch (error) {
                console.error('–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞:', error);
                orderResponse.innerHTML = `
                <div class="alert alert-danger">
                    –ü–æ–º–∏–ª–∫–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º. –ë—É–¥—å –ª–∞—Å–∫–∞, —Å–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.
                </div>
            `;
            }
        });

        const contactForm = document.getElementById('contactForm');
        const messageResponse = document.getElementById('messageResponse');

        contactForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const customerName = document.getElementById('contactName').value;
            const customerEmail = document.getElementById('contactEmail').value;
            const customerMessage = document.getElementById('contactMessage').value;

            messageResponse.innerHTML = '';
            try {
                const response = await fetch('/contactUs', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        customerName,
                        customerEmail,
                        customerMessage
                    })
                });

                const result = await response.json();
                if (response.ok) {
                    messageResponse.innerHTML = `
                    <div class="alert alert-success">${result.message}</div>
                `;
                    contactForm.reset();
                } else {
                    messageResponse.innerHTML = `
                    <div class="alert alert-danger">${result.message}</div>
                `;
                }
            } catch (error) {
                console.error('–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞:', error);
                messageResponse.innerHTML = `
                <div class="alert alert-danger">
                    –ü–æ–º–∏–ª–∫–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º. –ë—É–¥—å –ª–∞—Å–∫–∞, —Å–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.
                </div>
            `;
            }
        });
    });
</script>

</html>